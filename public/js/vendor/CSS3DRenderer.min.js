THREE.CSS3DObject=function(a){THREE.Object3D.call(this),this.element=a,this.element.style.position="absolute",this.addEventListener("removed",function(a){if(null!==this.element.parentNode){this.element.parentNode.removeChild(this.element);for(var b=0,c=this.children.length;c>b;b++)this.children[b].dispatchEvent(a)}})},THREE.CSS3DObject.prototype=Object.create(THREE.Object3D.prototype),THREE.CSS3DSprite=function(a){THREE.CSS3DObject.call(this,a)},THREE.CSS3DSprite.prototype=Object.create(THREE.CSS3DObject.prototype),THREE.CSS3DRenderer=function(){var a,b,c,d,e=new THREE.Matrix4,f=document.createElement("div");f.style.overflow="hidden",f.style.WebkitTransformStyle="preserve-3d",f.style.MozTransformStyle="preserve-3d",f.style.oTransformStyle="preserve-3d",f.style.transformStyle="preserve-3d",this.domElement=f;var g=document.createElement("div");g.style.WebkitTransformStyle="preserve-3d",g.style.MozTransformStyle="preserve-3d",g.style.oTransformStyle="preserve-3d",g.style.transformStyle="preserve-3d",f.appendChild(g),this.setClearColor=function(){},this.setSize=function(e,h){a=e,b=h,c=a/2,d=b/2,f.style.width=e+"px",f.style.height=h+"px",g.style.width=e+"px",g.style.height=h+"px"};var h=function(a){return Math.abs(a)<1e-6?0:a},i=function(a){var b=a.elements;return"matrix3d("+h(b[0])+","+h(-b[1])+","+h(b[2])+","+h(b[3])+","+h(b[4])+","+h(-b[5])+","+h(b[6])+","+h(b[7])+","+h(b[8])+","+h(-b[9])+","+h(b[10])+","+h(b[11])+","+h(b[12])+","+h(-b[13])+","+h(b[14])+","+h(b[15])+")"},j=function(a){var b=a.elements;return"translate3d(-50%,-50%,0) matrix3d("+h(b[0])+","+h(b[1])+","+h(b[2])+","+h(b[3])+","+h(-b[4])+","+h(-b[5])+","+h(-b[6])+","+h(-b[7])+","+h(b[8])+","+h(b[9])+","+h(b[10])+","+h(b[11])+","+h(b[12])+","+h(b[13])+","+h(b[14])+","+h(b[15])+")"},k=function(a,b){if(a instanceof THREE.CSS3DObject){var c=a.element;if(c.parentNode!==g&&g.appendChild(c),a.visible!==!1){a.wasVisible===!1&&(c.style.visibility="visible",a.wasVisible=!0);var d;a instanceof THREE.CSS3DSprite?(e.copy(b.matrixWorldInverse),e.transpose(),e.copyPosition(a.matrixWorld),e.scale(a.scale),e.elements[3]=0,e.elements[7]=0,e.elements[11]=0,e.elements[15]=1,d=j(e)):d=j(a.matrixWorld),c.style.WebkitTransform=d,c.style.MozTransform=d,c.style.oTransform=d,c.style.transform=d}else a.wasVisible!==!1&&(c.style.visibility="hidden",a.wasVisible=!1)}for(var f=0,h=a.children.length;h>f;f++)k(a.children[f],b)};this.render=function(a,e){var h=.5/Math.tan(THREE.Math.degToRad(.5*e.fov))*b;f.style.WebkitPerspective=h+"px",f.style.MozPerspective=h+"px",f.style.oPerspective=h+"px",f.style.perspective=h+"px",a.updateMatrixWorld(),void 0===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld);var j="translate3d(0,0,"+h+"px)"+i(e.matrixWorldInverse)+" translate3d("+c+"px,"+d+"px, 0)";g.style.WebkitTransform=j,g.style.MozTransform=j,g.style.oTransform=j,g.style.transform=j,k(a,e)}};